#!/usr/bin/env node
// ensures proper v numberfor nvm

// watches for image urls copied in system pasteboard
// (e.g. this one, autogenerated with iPic, e.g. http://ww4.sinaimg.cn/large/006tNc79ly1g4r9iftd9aj30wq0u01kz.jpg, which is auto-copied)
// uploads them to cloudinary
// replaces pasteboard with cloudinary url

const dotenv = require('dotenv')
dotenv.config()
const cloudinary = require('cloudinary').v2
const clipboardy = require('clipboardy')

cloudinary.config({
  cloud_name: process.env.CLOUD_NAME,
  api_key: process.env.API_KEY,
  api_secret: process.env.API_SECRET
})

cloudinary.uploader.upload(clipboardy.readSync(), (e, res) => {
  if (e) console.error(e)
  clipboardy.writeSync('![alt]' + res.secure_url + ')')
})
